let AntiBannerFiltersId,EventNotifierTypes,filtersMetadata;const Messages={OPTIONS_USERFILTER:i18n.getMessage("options_userfilter"),OPTIONS_WHITELIST:i18n.getMessage("options_whitelist"),IN_WHITELIST:i18n.getMessage("filtering_log_in_whitelist")},FilterRule={MASK_WHITE_LIST:"@@",MASK_CSS_RULE:"##",MASK_CSS_INJECT_RULE:"#$#",MASK_CSS_EXTENDED_CSS_RULE:"#?#",MASK_CSS_INJECT_EXTENDED_CSS_RULE:"#$?#",MASK_SCRIPT_RULE:"#%#",MASK_SCRIPT_RULE_UBO:"##"},UrlFilterRule={MASK_START_URL:"||",MASK_ANY_SYMBOL:"*",MASK_SEPARATOR:"^",DOMAIN_OPTION:"domain",IMPORTANT_OPTION:"important",MATCH_CASE_OPTION:"match-case",THIRD_PARTY_OPTION:"third-party",OPTIONS_DELIMITER:"$",CSP_OPTION:"csp",WEBRTC_OPTION:"webrtc",WEBSOCKET_OPTION:"websocket",COOKIE_OPTION:"cookie",STEALTH_OPTION:"stealth",REPLACE_OPTION:"replace",REDIRECT_OPTION:"redirect",BADFILTER_OPTION:"badfilter",REMOVEPARAM_OPTION:"removeparam"},STEALTH_ACTIONS={HIDE_REFERRER:1,HIDE_SEARCH_QUERIES:2,BLOCK_CHROME_CLIENT_DATA:4,SEND_DO_NOT_TRACK:8,FIRST_PARTY_COOKIES:16,THIRD_PARTY_COOKIES:32},STEALTH_ACTIONS_NAMES={HIDE_REFERRER:i18n.getMessage("filtering_log_hide_referrer"),HIDE_SEARCH_QUERIES:i18n.getMessage("filtering_log_hide_search_queries"),BLOCK_CHROME_CLIENT_DATA:i18n.getMessage("filtering_log_remove_client_data"),SEND_DO_NOT_TRACK:i18n.getMessage("filtering_log_send_not_track"),FIRST_PARTY_COOKIES:i18n.getMessage("options_modified_first_party_cookie"),THIRD_PARTY_COOKIES:i18n.getMessage("options_modified_third_party_cookie")},StringUtils={startWith(e,t){return!(!e||0!==e.indexOf(t))},containsIgnoreCase(e,t){return!!(e&&t&&0<=e.toUpperCase().indexOf(t.toUpperCase()))},substringAfter(e,t){if(!e)return e;var r=e.indexOf(t);return r<0?"":e.substring(r+t.length)},substringBefore(e,t){if(!e||!t)return e;t=e.indexOf(t);return t<0?e:e.substring(0,t)}},UrlUtils={getProtocol(e){let t=e.indexOf("//");return 0<=t?e.substring(0,t):(t=e.indexOf(":"),0<=t?e.substring(0,t):"")},getUrlWithoutScheme(e){let t=e.indexOf("//");return 0<=t?e=e.substring(t+2):(t=e.indexOf(":"),0<=t&&(e=e.substring(t+1))),StringUtils.startWith(e,"www.")?e.substring(4):e},isHierarchicUrl(e){return-1!==e.indexOf("//")}},ModalUtils={showModal(e){e.style.display="block"},closeModal(e){e.remove()}},RequestWizard=function(){let I,y,m,t;function b(e){L(),document.body.appendChild(e),ModalUtils.showModal(e),e.querySelector(".close").addEventListener("click",L),t=e}function s(e,t){var r=e.indexOf(t),s=t.length,e=e.slice(r+s);return(r=1,s="@",(t=t).slice(0,r)+s+t.slice(r))+e}function f(e){if(e.cspReportBlocked)return"CSP report";switch(e=e.requestType){case"DOCUMENT":case"SUBDOCUMENT":return"HTML";case"STYLESHEET":return"CSS";case"SCRIPT":return"JavaScript";case"XMLHTTPREQUEST":return"Ajax";case"IMAGE":return"Image";case"OBJECT":case"MEDIA":return"Media";case"FONT":return"Font";case"WEBSOCKET":return"WebSocket";case"WEBRTC":return"WebRTC";case"CSP":return"CSP";case"COOKIE":return"Cookie";case"OTHER":return"Other";default:return""}}function v(e){return e||""}function q(t){if(t===AntiBannerFiltersId.USER_FILTER_ID)return Messages.OPTIONS_USERFILTER;if(t===AntiBannerFiltersId.WHITE_LIST_FILTER_ID)return Messages.OPTIONS_WHITELIST;var e=filtersMetadata.filter(e=>e.filterId===t)[0];return e?e.name:""}const L=function(){t&&(ModalUtils.closeModal(t),t=null)},O=e=>{const t=e["ruleText"];return-1<t.indexOf(UrlFilterRule.OPTIONS_DELIMITER)?t+","+UrlFilterRule.BADFILTER_OPTION:t+UrlFilterRule.OPTIONS_DELIMITER+UrlFilterRule.BADFILTER_OPTION},A=function(e,r,s){var t=UrlUtils.isHierarchicUrl(e),l=UrlUtils.getProtocol(e);let n;n=t?UrlFilterRule.MASK_START_URL:l+":",s&&(n=FilterRule.MASK_WHITE_LIST+n);const i=[];s=StringUtils.substringAfter(e,r+"/");const a=StringUtils.substringBefore(s,"?");if(a){var o=a.split("/");let t=r+"/";for(let e=0;e<Math.min(o.length-1,2);e+=1)t+=o[e]+"/",i.push(n+t+UrlFilterRule.MASK_ANY_SYMBOL);s=o[o.length-1];s&&i.length<2&&(t+=s,i.push(n+t))}i.unshift(n+r+UrlFilterRule.MASK_SEPARATOR);e=UrlUtils.getUrlWithoutScheme(e);return r+"/"!==e&&i.indexOf(n+e)<0&&i.push(n+e),i},N=(e,t,r,s,l,n)=>{let i=e,a=[];return t&&a.push(UrlFilterRule.DOMAIN_OPTION+"="+t),l&&a.push(UrlFilterRule.IMPORTANT_OPTION),r&&a.push(UrlFilterRule.MATCH_CASE_OPTION),s&&a.push(UrlFilterRule.THIRD_PARTY_OPTION),n&&(a=a.concat(n)),0<a.length&&(i+=UrlFilterRule.OPTIONS_DELIMITER+a.join(",")),i},C=function(e,u,t,d){const h=d["frameDomain"];var r=d.requestThirdParty;const s=u.querySelector("#rulePatterns");for(let e=0;e<t.length;e+=1){const a=t[e];var l=a.replace(/"/g,"&quot;"),l=`
                <li class="checkb-wrap">
                    <div class="radio">
                        <input
                            class="radio__input"
                            type="radio"
                            name="rulePattern"
                            id="pattern${e}"
                            value="${l}"
                            ${0===e?"checked='checked'":""}
                        >
                        <label class="radio__label" for="pattern${e}">
                            ${a}
                        </label>
                    </div>
                </li>`;s.appendChild(htmlToElement(l))}const n=[].slice.call(u.querySelectorAll('[name="rulePattern"]')),T=u.querySelector('[name="ruleDomain"]'),E=u.querySelector('[name="ruleImportant"]'),_=u.querySelector('[name="ruleMatchCase"]'),S=u.querySelector('[name="ruleThirdParty"]'),R=u.querySelector('[name="ruleText"]');if(T.setAttribute("id","ruleDomain"),T.parentNode.querySelector("label").setAttribute("for","ruleDomain"),h||(T.closest(".checkbox").style.display="none"),E.setAttribute("id","ruleImportant"),E.parentNode.querySelector("label").setAttribute("for","ruleImportant"),d.requestRule&&(d.requestRule.whiteListRule||d.requestRule.isImportant)&&E.setAttribute("checked","checked"),_.setAttribute("id","ruleMatchCase"),_.parentNode.querySelector("label").setAttribute("for","ruleMatchCase"),S.setAttribute("id","ruleThirdParty"),S.parentNode.querySelector("label").setAttribute("for","ruleThirdParty"),r&&!h&&S.setAttribute("checked","checked"),d.element||d.script){E.parentNode.style.display="none",_.parentNode.style.display="none",S.parentNode.style.display="none";const o=u.querySelector(".filtering-modal-patterns");o&&(o.style.display="none");const c=u.querySelector(".filtering-modal-options");c&&(c.style.display="none")}if(d.cookieName){E.parentNode.style.display="none",_.parentNode.style.display="none",T.parentNode.style.display="none";const p=u.querySelector(".filtering-modal-patterns");p&&(p.style.display="none")}if(d.requestRule&&d.requestRule.documentLevelRule){const g=u.querySelector(".filtering-modal-options");g&&(g.style.display="none"),T.setAttribute("checked","checked"),E.removeAttribute("checked")}function i(){var e=u.querySelector('[name="rulePattern"]:checked').value,t=!T.checked,r=!!E.checked,s=!!_.checked,l=!!S.checked,n=t?h:null;let i=null;var a=d["requestRule"];a&&a.cspRule&&(i=[UrlFilterRule.CSP_OPTION]),a&&a.cookieRule&&(i=[UrlFilterRule.COOKIE_OPTION]),"content-security-policy-check"===d.requestUrl&&(i=[UrlFilterRule.WEBRTC_OPTION,UrlFilterRule.WEBSOCKET_OPTION]);var{replaceRules:o,removeparamRules:a}=d;o&&(i=[UrlFilterRule.REPLACE_OPTION]),a&&(i=[UrlFilterRule.REMOVEPARAM_OPTION]);let c;c=d.element?function(e,t){let r=e;return t||(r=r.slice(r.indexOf("#"))),r}(e,t):d.cookieName?N(e,null,null,l,r,i):d.script?N(e):N(e,n,s,l,r,i),R.value=c}T.addEventListener("change",i),E.addEventListener("change",i),_.addEventListener("change",i),S.addEventListener("change",i),n.forEach(e=>{e.addEventListener("change",i)}),u.querySelector("#createRule").addEventListener("click",e=>{e.preventDefault();e=R.value;e&&(contentPage.sendMessage({type:"addUserRule",ruleText:e}),L())}),i(),b(u)},M=function(e,t){const r=e["ruleText"];t=t.frameDomain;return-1<r.indexOf(FilterRule.MASK_CSS_INJECT_RULE)?t+s(r,FilterRule.MASK_CSS_INJECT_RULE):-1<r.indexOf(FilterRule.MASK_CSS_EXTENDED_CSS_RULE)?t+s(r,FilterRule.MASK_CSS_EXTENDED_CSS_RULE):-1<r.indexOf(FilterRule.MASK_CSS_INJECT_EXTENDED_CSS_RULE)?t+s(r,FilterRule.MASK_CSS_INJECT_EXTENDED_CSS_RULE):-1<r.indexOf(FilterRule.MASK_CSS_RULE)?t+s(r,FilterRule.MASK_CSS_RULE):void 0},U=function(e,t){const r=e["ruleText"];t=t.frameDomain;return-1<r.indexOf(FilterRule.MASK_SCRIPT_RULE)?t+s(r,FilterRule.MASK_SCRIPT_RULE):-1<r.indexOf(FilterRule.MASK_SCRIPT_RULE_UBO)?t+s(r,FilterRule.MASK_SCRIPT_RULE_UBO):void 0},P=function(e,t){let r=t.frameDomain;return"."===r[0]&&(r=r.substring(1)),FilterRule.MASK_WHITE_LIST+UrlFilterRule.MASK_START_URL+r};return{initRequestWizard:function(){I=document.querySelector("#modal-request-info"),y=document.querySelector("#modal-create-block-rule"),m=document.querySelector("#modal-create-exception-rule")},showRequestInfoModal:function(t,r){const e=I.cloneNode(!0),{requestRule:s,replaceRules:l,stealthActions:n,removeparamRules:i}=r,a=e.querySelector('[attr-text="requestUrl"]');r.requestUrl?a.textContent=r.requestUrl:a.parentNode.style.display="none";const o=e.querySelector('[attr-text="element"]');r.element?o.textContent=r.element:o.parentNode.style.display="none";const c=e.querySelector('[attr-text="cookie"]');if(r.cookieName?c.textContent=r.cookieName+" = "+r.cookieValue:c.parentNode.style.display="none",e.querySelector('[attr-text="requestType"]').textContent=f(r),e.querySelector('[attr-text="frameDomain"]').textContent=v(r.frameDomain),r.frameDomain||(e.querySelector('[attr-text="frameDomain"]').closest("li").style.display="none"),s&&!s.replaceRule&&void 0!==s.filterId){if(s.filterId!==AntiBannerFiltersId.WHITE_LIST_FILTER_ID){const S=e.querySelector('[attr-text="requestRule"]');var u;S.textContent=s.ruleText,s.convertedRuleText&&(u=`&nbsp<i>(Converted to: ${s.convertedRuleText})</i>`,S.insertAdjacentHTML("beforeend",u))}else e.querySelector('[attr-text="requestRule"]').closest("li").style.display="none";e.querySelector('[attr-text="multipleRules"]').closest("li").style.display="none",e.querySelector('[attr-text="requestRuleFilter"]').textContent=q(s.filterId)}else e.querySelector('[attr-text="requestRule"]').closest("li").style.display="none",e.querySelector('[attr-text="requestRuleFilter"]').closest("li").style.display="none";if(l||i){const R=l||i;e.querySelector('[attr-text="requestRule"]').closest("li").style.display="none",e.querySelector('[attr-text="requestRuleFilter"]').closest("li").style.display="none",0<R.length?e.querySelector('[attr-text="multipleRules"]').textContent=R.map(e=>e.ruleText).join("\r\n"):e.querySelector('[attr-text="multipleRules"]').closest("li").style.display="none"}else e.querySelector('[attr-text="multipleRules"]').closest("li").style.display="none";if(n?e.querySelector('[attr-text="stealthActions"]').textContent=(r=>{const s=[];return Object.keys(STEALTH_ACTIONS).forEach(e=>{var t=STEALTH_ACTIONS[e];(r&t)===t&&s.push(STEALTH_ACTIONS_NAMES[e])}),s})(n).join("\r\n"):e.querySelector('[attr-text="stealthActions"]').closest("li").style.display="none","IMAGE"===r.requestType){e.classList.remove("compact-view");const p=e.querySelector('[attr-src="requestUrl"]'),g=new Image;g.src=r.requestUrl,g.onload=function(){var e=this["width"],t=this["height"];1<e&&1<t&&(p.setAttribute("src",r.requestUrl),p.parentNode.style.display="block")}}const d=e.querySelector("#openRequestNewTab"),h=e.querySelector("#blockRequest"),T=e.querySelector("#unblockRequest"),E=e.querySelector("#removeWhiteListDomain"),_=e.querySelector("#removeUserFilterRule");d.addEventListener("click",e=>{e.preventDefault();let t=r["requestUrl"];"content-security-policy-check"===t&&(t=r.frameUrl),contentPage.sendMessage({type:"openTab",url:t,options:{inNewWindow:!0}})}),(r.element||r.cookieName||r.script)&&(d.style.display="none"),h.addEventListener("click",e=>{e.preventDefault(),L(),function(e,t){var r=y.cloneNode(!0);let s=A(t.requestUrl,t.requestDomain,!1).reverse();t.requestRule&&t.requestRule.documentLevelRule&&(s=[O(t.requestRule)]),C(e,r,s,t)}(t,r)}),T.addEventListener("click",e=>{e.preventDefault(),L(),function(e,t){var r=m.cloneNode(!0);let s;t.requestUrl&&(s=A(t.requestUrl,t.requestDomain,!0).reverse()),"content-security-policy-check"===t.requestUrl&&(s=[FilterRule.MASK_WHITE_LIST]),t.element&&(s=[M(t.requestRule,t)]),t.cookieName&&(s=[P(t.requestRule,t)]),t.script&&(s=[U(t.requestRule,t)]),C(e,r,s,t)}(t,r)}),E.addEventListener("click",e=>{e.preventDefault(),contentPage.sendMessage({type:"unWhiteListFrame",frameInfo:t}),L()}),_.addEventListener("click",e=>{e.preventDefault(),contentPage.sendMessage({type:"removeUserRule",ruleText:s.ruleText}),L()}),s?s.filterId===AntiBannerFiltersId.USER_FILTER_ID?(_.classList.remove("hidden"),s.whiteListRule&&h.classList.remove("hidden")):s.filterId===AntiBannerFiltersId.WHITE_LIST_FILTER_ID?E.classList.remove("hidden"):s.whiteListRule?s.whiteListRule&&h.classList.remove("hidden"):T.classList.remove("hidden"):r.cspReportBlocked||h.classList.remove("hidden"),b(e)},closeModal:L,getFilterName:q,getRequestType:f,getSource:v}}(),PageController=function(){};PageController.prototype={init(){RequestWizard.initRequestWizard(),this.logTable=document.querySelector("#logTable"),this.logTableEmpty=document.querySelector("#logTableEmpty"),this.logTableHidden=!0,this.logoIcon=document.querySelector("#logoIcon"),this.tabSelector=document.querySelector("#tabSelector"),this.tabSelector.addEventListener("change",e=>{document.location.hash="#"+e.target.selectedOptions[0].getAttribute("data-tab-id")}),window.addEventListener("hashchange",()=>{this._updateTabIdFromHash(),this.onSelectedTabChange()}),this.preserveLogEnabled=!1,this.searchRequest=null,this.searchTypes=[],this.searchThirdParty=!1,this.searchBlocked=!1,this.searchWhitelisted=!1;const e=[].slice.call(document.querySelectorAll(".reloadTab"));e.length<=0||(e.forEach(e=>{e.addEventListener("click",e=>(e.preventDefault(),-1===this.currentTabId?this.preserveLogEnabled?void 0:(contentPage.sendMessage({type:"clearEventsByTabId",tabId:this.currentTabId}),void this.emptyLogTable()):void contentPage.sendMessage({type:"reloadTabById",tabId:this.currentTabId,preserveLogEnabled:this.preserveLogEnabled})))}),document.querySelector("#clearTabLog").addEventListener("click",e=>{e.preventDefault(),this.emptyLogTable(),contentPage.sendMessage({type:"clearEventsByTabId",tabId:this.currentTabId})}),this._bindSearchFilters(),document.querySelector("#preserveLog").addEventListener("click",e=>{const t=e.currentTarget.querySelector(".checkbox");this.preserveLogEnabled=t.classList.contains("active")}),this._updateTabIdFromHash(),contentPage.sendMessage({type:"synchronizeOpenTabs"},e=>{var t=e["tabs"];for(let e=0;e<t.length;e+=1)this.onTabUpdated(t[e]);this.onSelectedTabChange()}),document.addEventListener("keyup",e=>{27===e.keyCode&&RequestWizard.closeModal()}),this.logTable.addEventListener("click",e=>{e.preventDefault();let t=e.target,r=!1;for(;t!==this.logTable&&!r;)"TR"===t.tagName?r=!0:t=t.parentNode;const s=r&&t.data;s&&contentPage.sendMessage({type:"getTabFrameInfoById",tabId:this.currentTabId},e=>{e=e.frameInfo;e&&RequestWizard.showRequestInfoModal(e,s)})}))},_updateTabIdFromHash(){var e;!document.location.hash||(e=document.location.hash.substring(1))&&(this.currentTabId=Number(e))},onTabAdded(e){if(!e.isExtensionTab){const t=document.createElement("option");t.textContent=e.title,t.setAttribute("data-tab-id",e.tabId),this.tabSelector.appendChild(t),this.currentTabId||this.onSelectedTabChange()}},onTabUpdated(e){const t=this.tabSelector.querySelector(`[data-tab-id="${e.tabId}"]`);e.isExtensionTab?this.onTabClose(e):t?(t.textContent=e.title,e.tabId===this.currentTabId&&(document.querySelector(`[data-tab-id="${this.currentTabId}"]`).selected=!0,this._updateLogoIcon())):this.onTabAdded(e)},onTabClose(e){const t=this.tabSelector.querySelector(`[data-tab-id="${e.tabId}"]`);t&&(t.parentNode.removeChild(t),this.currentTabId===e.tabId&&(this.currentTabId=null,this.onSelectedTabChange()))},emptyLogTable(){for(;this.logTable.firstChild;)this.logTable.removeChild(this.logTable.firstChild)},onTabReset(e){this.currentTabId!==e.tabId||this.preserveLogEnabled||(this.emptyLogTable(),this._onEmptyTable())},onEventAdded(e,t){this.currentTabId===e.tabId&&("DOCUMENT"!==t.requestType||t.element||t.script||this.preserveLogEnabled||this.onTabReset(e),this._renderEvents([t]))},onEventUpdated(e,t){if(this.currentTabId===e.tabId){const r=this.logTable.querySelector("#request-"+t.eventId);r&&(t=this._renderTemplate(t),this._handleEventShow(t),r.parentNode.replaceChild(t,r))}},onSelectedTabChange(){let e=this.tabSelector.querySelector(`[data-tab-id="${this.currentTabId}"]`);e=e||this.tabSelector.firstChild;let t=null;e&&(t=e.getAttribute("data-tab-id")),this.currentTabId=Number(t);const r=document.querySelector(`[data-tab-id="${this.currentTabId}"]`);r&&(r.selected=!0),this._updateLogoIcon(),this._renderEventsForTab(this.currentTabId),RequestWizard.closeModal()},_updateLogoIcon(){contentPage.sendMessage({type:"getTabFrameInfoById",tabId:this.currentTabId},e=>{this.logoIcon.setAttribute("src","images/shield.svg")})},removeClass(e,t){e.forEach(e=>{e.classList.remove(t)})},_bindSearchFilters(){const s=this;document.querySelector('[name="searchEventRequest"]').addEventListener("keyup",function(){s.searchRequest=this.value.trim(),s._filterEvents()});const l=[].slice.call(document.querySelectorAll(".searchEventType"));l.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),s.removeClass(l,"active");const t=e.currentTarget;t.classList.add("active");const r=t.getAttribute("attr-type");s.searchTypes=r?r.split(","):[],s._filterEvents()})});const e=[].slice.call(document.querySelectorAll(".checkb-wrap"));e.forEach(r=>{r.addEventListener("click",()=>{const e=r.querySelector(".checkbox");e.classList.toggle("active");var t=e.classList.contains("active");r.classList.contains("searchEventThirdParty")?s.searchThirdParty=t:r.classList.contains("searchEventBlocked")?s.searchBlocked=t:r.classList.contains("searchEventWhitelisted")&&(s.searchWhitelisted=t),s._filterEvents()})})},_filterEvents(){const e=this.logTable.childNodes;this.searchRequest||0!==this.searchTypes.length||this.searchThirdParty||this.searchBlocked||this.searchWhitelisted?e.forEach(e=>{this._handleEventShow(e)}):this.removeClass(e,"hidden")},_onEmptyTable(){this.logTableHidden=!0,this.logTable.classList.add("hidden"),this.logTableEmpty.classList.remove("hidden")},_onNotEmptyTable(){this.logTableHidden&&(this.logTableHidden=!1,this.logTableEmpty.classList.add("hidden"),this.logTable.classList.remove("hidden"))},_renderEventsForTab(e){this.emptyLogTable(),contentPage.sendMessage({type:"getFilteringInfoByTabId",tabId:e},e=>{e=e.filteringInfo;let t=[];e&&(t=e.filteringEvents||[]),this._renderEvents(t)})},_renderEvents(t){if(t&&0!==t.length){const s=[];for(let e=0;e<t.length;e+=1){var r=this._renderTemplate(t[e]);this._handleEventShow(r),s.push(r)}this._onNotEmptyTable(),s.forEach(function(e){this.logTable.appendChild(e)})}else this._onEmptyTable()},_escapeHTML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},_renderTemplate(e){const t={data:e,class:""};e.filterName="",e.requestRule&&void 0!==e.requestRule.filterId?e.filterName=RequestWizard.getFilterName(e.requestRule.filterId):e.stealthActions&&(e.filterName=i18n.getMessage("filtering_log_privacy_applied_rules")),e.replaceRules&&(t.class+=" yellow"),e.removeparamRules&&(t.class+=" yellow"),e.cspReportBlocked&&(t.class+=" red"),!e.requestRule||e.replaceRules||e.cspReportBlocked||e.removeparamRules||(e.requestRule.whiteListRule?t.class+=" green":e.requestRule.cssRule||e.requestRule.scriptRule||e.requestRule.cookieRule&&e.requestRule.isModifyingCookieRule?t.class+=" yellow":t.class+=" red"),e.eventId&&(t.id="request-"+e.eventId);let r;r=e.element?this._escapeHTML(e.element):e.cookieName?e.cookieName+" = "+e.cookieValue:e.requestUrl;let s="";var l;e.requestRule&&(s=e.requestRule.filterId===AntiBannerFiltersId.WHITE_LIST_FILTER_ID?Messages.IN_WHITELIST:e.requestRule.ruleText),e.replaceRules&&(l=e.replaceRules.length,s=i18n.getMessage("filtering_log_modified_rules")+" "+l),e.removeparamRules&&(l=e.removeparamRules.length,s=i18n.getMessage("filtering_log_modified_rules")+" "+l);let n="";e.requestThirdParty&&(n='<img src="images/chain-link.svg" class="icon-chain"><small>Third party</small>');e=`
            <tr ${t.id?`id="${t.id}"`:""}
                ${t.class?`class="${t.class}"`:""}>
                <td>${r}</td>
                <td>
                    ${RequestWizard.getRequestType(e)}
                    ${n}
                </td>
                <td>${s||""}</td>
                <td>
                    ${e.filterName}
                </td>
                <td>${RequestWizard.getSource(e.frameDomain)}</td>
            </tr>
        `;const i=htmlToElement(e);return i.data=t.data,i},_handleEventShow(e){var t=e.data;let r=!this.searchRequest||StringUtils.containsIgnoreCase(t.requestUrl,this.searchRequest)||StringUtils.containsIgnoreCase(t.element,this.searchRequest)||StringUtils.containsIgnoreCase(t.cookieName,this.searchRequest)||StringUtils.containsIgnoreCase(t.cookieValue,this.searchRequest);t.requestRule&&t.requestRule.ruleText&&(r|=StringUtils.containsIgnoreCase(t.requestRule.ruleText,this.searchRequest)),t.filterName&&(r|=StringUtils.containsIgnoreCase(t.filterName,this.searchRequest)),r&=0===this.searchTypes.length||0<=this.searchTypes.indexOf(t.requestType);var s=!0;s&=!this.searchWhitelisted||t.requestRule&&t.requestRule.whiteListRule,s&=!this.searchBlocked||t.requestRule&&!t.requestRule.whiteListRule,s&=!this.searchThirdParty||t.requestThirdParty,r&=!(this.searchWhitelisted||this.searchBlocked||this.searchThirdParty)||s,r?e.classList.remove("hidden"):e.classList.add("hidden")}},contentPage.sendMessage({type:"initializeFrameScript"},e=>{filtersMetadata=e.filtersMetadata,AntiBannerFiltersId=e.constants.AntiBannerFiltersId,EventNotifierTypes=e.constants.EventNotifierTypes;function t(){const s=new PageController;s.init();var e=[EventNotifierTypes.TAB_ADDED,EventNotifierTypes.TAB_UPDATE,EventNotifierTypes.TAB_CLOSE,EventNotifierTypes.TAB_RESET,EventNotifierTypes.LOG_EVENT_ADDED,EventNotifierTypes.LOG_EVENT_UPDATED];contentPage.sendMessage({type:"onOpenFilteringLogPage"}),createEventListener(e,(e,t,r)=>{switch(e){case EventNotifierTypes.TAB_ADDED:case EventNotifierTypes.TAB_UPDATE:s.onTabUpdated(t);break;case EventNotifierTypes.TAB_CLOSE:s.onTabClose(t);break;case EventNotifierTypes.TAB_RESET:s.onTabReset(t);break;case EventNotifierTypes.LOG_EVENT_ADDED:s.onEventAdded(t,r);break;case EventNotifierTypes.LOG_EVENT_UPDATED:s.onEventUpdated(t,r)}},()=>{contentPage.sendMessage({type:"onCloseFilteringLogPage"})})}(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?t():document.addEventListener("DOMContentLoaded",t)});