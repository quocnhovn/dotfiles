adguard.whitelist=function(r){var n="white-list-domains",s="block-list-domains",e="is-whiteList-filter-status",i="is-blackList-filter-status",l=new r.rules.UrlFilterRule("@@whitelist-all$document",r.utils.filters.WHITE_LIST_FILTER_ID),a=new r.rules.UrlFilter,o=new r.rules.UrlFilter;function u(){return d.domains,a}function c(){return m.domains,o}function f(){return r.settings.isDefaultWhiteListMode()}function g(t){return(t=r.utils.url.getHost(t)?r.utils.url.getHost(t):t).replace("www.","*.")}var d={get domains(){return r.lazyGet(d,"domains",function(){a=new r.rules.UrlFilter;for(var t=w(n),e=0;e<t.length;e++){var i=L(g(t[e]));i&&a.addRule(i)}return t})},add:function(t){this.domains.indexOf(t)<0&&this.domains.push(t)}},m={get domains(){return r.lazyGet(m,"domains",function(){o=new r.rules.UrlFilter;for(var t=w(s),e=0;e<t.length;e++){var i=L(t[e]);i&&o.addRule(i)}return t})},add:function(t){this.domains.indexOf(t)<0&&this.domains.push(t)}};function h(){r.listeners.notifyListeners(r.listeners.UPDATE_WHITELIST_FILTER_RULES)}function L(t){return r.utils.strings.isEmpty(t)?null:r.rules.builder.createRule("@@//"+t+"$document",r.utils.filters.WHITE_LIST_FILTER_ID)}function S(t){var e=L(t);e&&(f()?u:c)().removeRule(e),(t=t)&&(f()?r.utils.collections.removeAll(d.domains,t):r.utils.collections.removeAll(m.domains,t)),v(),h()}function v(){r.localStorage.setItem(n,JSON.stringify(d.domains)),r.localStorage.setItem(s,JSON.stringify(m.domains))}function I(t,e){r.localStorage.setItem(t,JSON.stringify(e))}function w(e){var t=[];try{var i=r.localStorage.getItem(e);i&&(t=JSON.parse(i))}catch(t){r.console.error("Error retrieve whitelist domains {0}, cause {1}",e,t)}return t}function D(t){var e=L(t);e&&((f()?u:c)().addRule(e),(t=t)&&(f()?d:m).add(t),v(),h())}function W(){return r.localStorage.getItem(i)}function p(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];d.add(i);i=L(g(t[e]));i&&a.addRule(i)}v()}}function y(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];m.add(i);i=L(i);i&&o.addRule(i)}v()}}function R(){r.localStorage.removeItem(n),r.lazyGetClear(d,"domains"),a=new r.rules.UrlFilter}function U(){r.localStorage.removeItem(s),r.lazyGetClear(m,"domains"),o=new r.rules.UrlFilter}return{init:function(){r.lazyGetClear(d,"domains"),r.lazyGetClear(m,"domains")},getRules:function(){return u().getRules()},getWhiteListDomains:function(){return(f()?d:m).domains},optionsSysWhiteListlData:function(t,e){var i="sys_white_list";if("get"==t){var n=r.localStorage.getItem(i)||"[]";return JSON.parse(n)}if("set"==t)return r.localStorage.setItem(i,JSON.stringify(e))||[]},optionsUserWhiteListlData:function(t,e){var i="user_white_list";if("get"==t){var n=r.localStorage.getItem(i)||"[]";return JSON.parse(n)}if("set"==t)return r.localStorage.setItem(i,JSON.stringify(e))||[]},optionsUserBlackListlData:function(t,e){var i="user_black_list";if("get"==t){var n=r.localStorage.getItem(i)||"[]";return JSON.parse(n)}if("set"==t)return r.localStorage.setItem(i,JSON.stringify(e))||[]},filterWhiteListChange:function(t){let e=r.whitelist.optionsUserWhiteListlData("get");var i=r.whitelist.optionsSysWhiteListlData("get");e=e.map(t=>r.utils.url.getHost(t)||t);i=[...e,...i];if("getFilterWhiteList"===t)return i;r.whitelist.updateWhiteListDomains(i)},getWhiteListedDomains:function(){return d.domains},getBlockListedDomains:function(){return m.domains},findWhiteListRule:function(t){if(!t)return null;var e=r.utils.url.getHost(t);return f()?"false"===W()&&function(t){let e=r.whitelist.optionsUserBlackListlData("get");e=e.map(t=>r.utils.url.getHost(t)||t);t=r.utils.url.getHost(t);return e.includes(t)}(t)?null:u().isFiltered(t,e,r.RequestTypes.DOCUMENT,!1):c().isFiltered(t,e,r.RequestTypes.DOCUMENT,!1)?null:l},whiteListUrl:function(t){t=r.utils.url.getHost(t);(f()?D:S)(t)},unWhiteListUrl:function(t){t=r.utils.url.getHost(t);(f()?S:D)(t)},updateWhiteListDomains:function(t){t=t||[],f()?(R(),p(t)):(U(),y(t)),h()},configure:function(t,e,i){R(),U(),p(t||[]),y(e||[]),r.settings.changeDefaultWhiteListMode(i),h()},isDefaultMode:f,changeDefaultWhiteListMode:function(t){r.settings.changeDefaultWhiteListMode(t),h()},changeWhiteListFilter:function(){var t=r.localStorage.getItem(e);I(e,"false"==t)},getWhiteListBtnStatus:function(){return r.localStorage.getItem(e)},changeBlackListFilter:()=>{var t=r.localStorage.getItem(i);I(i,"false"==t)},getBlackListBtnStatus:W}}(adguard);