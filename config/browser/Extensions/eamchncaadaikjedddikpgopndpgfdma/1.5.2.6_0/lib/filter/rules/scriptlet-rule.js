!function(t,s){const i=t.utils.strings,n="//scriptlet";function l(t){t=i.substringAfter(t,n);const l={OPENED:"opened",PARAM:"param",CLOSED:"closed"};var e={[l.OPENED]:(t,e,{sep:r})=>{var s=t[e];switch(s){case" ":case"(":case",":return l.OPENED;case"'":case'"':return r.symb=s,l.PARAM;case")":return e===t.length-1?l.CLOSED:l.OPENED}},[l.PARAM]:(t,e,{saver:r,sep:s})=>{var i=t[e];switch(i){case"'":case'"':var n=t[e-1];if(i===s.symb&&"\\"!==n)return s.symb=null,r.saveStr(),l.OPENED;default:return r.saveSymb(i),l.PARAM}},[l.CLOSED]:()=>{}};const r=function(){let e="";const t=[];return{saveSymb:t=>e+=t,saveStr:()=>{t.push(e),e=""},getAll:()=>[...t]}}();if("closed"!==function(e,r,t,s){let i=t||Object.keys(r)[0];for(let t=0;t<e.length;t++)i=r[i](e,t,s);return i}(t,e,l.OPENED,{sep:{symb:null},saver:r}))throw new Error("Invalid scriptlet rule "+t);const s=r.getAll();return{name:s[0],args:s.slice(1)}}function e(t,e){this.ruleText=t,this.filterId=e,this.scriptSource="local",this.whiteListRule=t.includes(s.FilterRule.MASK_SCRIPT_EXCEPTION_RULE);var r=this.whiteListRule?s.FilterRule.MASK_SCRIPT_EXCEPTION_RULE:s.FilterRule.MASK_SCRIPT_RULE,e=i.substringBefore(t,r);e&&this.loadDomains(e),this.ruleContent=i.substringAfter(t,r),this.scriptletParams=l(t)}e.isAdguardScriptletRule=t=>-1<t.indexOf(n),((e.prototype=Object.create(s.FilterRule.prototype)).constructor=e).prototype.getScript=function(t){return!(!t||!t.debug)==!!this.scriptletParams.debug&&this.script||(this.scriptletParams=Object.assign({},this.scriptletParams,t,{ruleText:this.ruleText}),this.script=(t=>{var{name:e,args:r,ruleText:s,domainName:i,engine:n,version:l,debug:t}=t;if(!scriptlets)return null;const u={name:e,args:r,ruleText:s,domainName:i,engine:n,version:l};return t&&(u.verbose=!0),scriptlets.invoke(u)})(this.scriptletParams)),this.script},e.prototype.getRuleContent=function(){return this.ruleContent},s.ScriptletRule=e}(adguard,adguard.rules);