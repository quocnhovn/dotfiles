!function(e){e="object"==typeof exports?exports:"object"==typeof e?e:{};!function(e){const o=Symbol("newer"),r=Symbol("older");function t(e,t){if(typeof e!=="number"){t=e;e=0}this.size=0;this.limit=e;this.oldest=this.newest=undefined;this._keymap=new Map;if(t){this.assign(t);if(e<1)this.limit=this.size}}function u(e,t){this.key=e;this.value=t;this[o]=undefined;this[r]=undefined}function i(e){this.entry=e}function n(e){this.entry=e}function s(e){this.entry=e}(e.LRUMap=t).prototype._markEntryAsUsed=function(e){if(e===this.newest)return;if(e[o]){if(e===this.oldest)this.oldest=e[o];e[o][r]=e[r]}if(e[r])e[r][o]=e[o];e[o]=undefined;e[r]=this.newest;if(this.newest)this.newest[o]=e;this.newest=e},t.prototype.assign=function(e){let i,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let s=e[Symbol.iterator]();for(let t=s.next();!t.done;t=s.next()){let e=new u(t.value[0],t.value[1]);this._keymap.set(e.key,e);if(!i)this.oldest=e;else{i[o]=e;e[r]=i}i=e;if(n--==0)throw new Error("overflow")}this.newest=i;this.size=this._keymap.size},t.prototype.get=function(e){var t=this._keymap.get(e);if(!t)return;this._markEntryAsUsed(t);return t.value},t.prototype.set=function(e,t){var i=this._keymap.get(e);if(i){i.value=t;this._markEntryAsUsed(i);return this}this._keymap.set(e,i=new u(e,t));if(this.newest){this.newest[o]=i;i[r]=this.newest}else this.oldest=i;this.newest=i;++this.size;if(this.size>this.limit)this.shift();return this},t.prototype.shift=function(){var e=this.oldest;if(e){if(this.oldest[o]){this.oldest=this.oldest[o];this.oldest[r]=undefined}else{this.oldest=undefined;this.newest=undefined}e[o]=e[r]=undefined;this._keymap.delete(e.key);--this.size;return[e.key,e.value]}},t.prototype.find=function(e){let t=this._keymap.get(e);return t?t.value:undefined},t.prototype.has=function(e){return this._keymap.has(e)},t.prototype["delete"]=function(e){var t=this._keymap.get(e);if(!t)return;this._keymap.delete(t.key);if(t[o]&&t[r]){t[r][o]=t[o];t[o][r]=t[r]}else if(t[o]){t[o][r]=undefined;this.oldest=t[o]}else if(t[r]){t[r][o]=undefined;this.newest=t[r]}else this.oldest=this.newest=undefined;this.size--;return t.value},t.prototype.clear=function(){this.oldest=this.newest=undefined;this.size=0;this._keymap.clear()},i.prototype[Symbol.iterator]=function(){return this},i.prototype.next=function(){let e=this.entry;if(e){this.entry=e[o];return{done:false,value:[e.key,e.value]}}else return{done:true,value:undefined}},n.prototype[Symbol.iterator]=function(){return this},n.prototype.next=function(){let e=this.entry;if(e){this.entry=e[o];return{done:false,value:e.key}}else return{done:true,value:undefined}},s.prototype[Symbol.iterator]=function(){return this},s.prototype.next=function(){let e=this.entry;if(e){this.entry=e[o];return{done:false,value:e.value}}else return{done:true,value:undefined}},t.prototype.keys=function(){return new n(this.oldest)},t.prototype.values=function(){return new s(this.oldest)},t.prototype.entries=function(){return this},t.prototype[Symbol.iterator]=function(){return new i(this.oldest)},t.prototype.forEach=function(e,t){if(typeof t!=="object")t=this;let i=this.oldest;while(i){e.call(t,i.value,i.key,this);i=i[o]}},t.prototype.toJSON=function(){var e=new Array(this.size),t=0,i=this.oldest;while(i){e[t++]={key:i.key,value:i.value};i=i[o]}return e},t.prototype.toString=function(){var e="",t=this.oldest;while(t){e+=String(t.key)+":"+t.value;t=t[o];if(t)e+=" < "}return e}}(e),"function"==typeof define&&define.amd&&define("lru",e)}(this);