adguard.hitStats=function(n){"use strict";var t,a=20,i="filters-hit-count",c={get hitStats(){return n.lazyGet(c,"hitStats",e)}};function e(){var t=n.localStorage.getItem(i),e=Object.create(null);try{t&&(e=JSON.parse(t))}catch(t){n.console.error("Error retrieve hit count statistic, cause {0}",t)}return e}function l(e){t&&clearTimeout(t),t=setTimeout(function(){try{n.localStorage.setItem(i,JSON.stringify(e))}catch(t){n.console.error("Error save hit count statistic to storage, cause {0}",t)}var t;(c.hitStats.views||0)<a||(t=n.filters.getEnabledFilters(),n.backend.sendHitStats(JSON.stringify(c.hitStats),t),s())},2e3)}function s(){n.localStorage.removeItem(i),n.lazyGetClear(c,"hitStats")}return n.settings.onUpdated.addListener(function(t){t!==n.settings.DISABLE_COLLECT_HITS||n.settings.collectHitsCount()||s()}),{addRuleHit:function(t,e,a,i){var s,r;t&&e&&a&&((s=c.hitStats.domains?c.hitStats.domains[t]:null)&&((t=s.rules)||(s.rules=t=Object.create(null)),(s=t[a])||(t[a]=s=Object.create(null)),e in s||(s[e]=null),(a=s[e])||(s[e]=a=Object.create(null)),i?(r=a[i=n.utils.url.getDomainName(i)]||0,a[i]=r+1):(r=a.h||0,a.h=r+1),l(c.hitStats)))},addDomainView:function(t){var e,a;t&&((e=c.hitStats.domains)||(c.hitStats.domains=e=Object.create(null)),(a=e[t])||(e[t]=a=Object.create(null),a.views=0),a.views++,c.hitStats.views=(c.hitStats.views||0)+1,l(c.hitStats))},cleanup:s,getStats:function(){return c.hitStats}}}(adguard);