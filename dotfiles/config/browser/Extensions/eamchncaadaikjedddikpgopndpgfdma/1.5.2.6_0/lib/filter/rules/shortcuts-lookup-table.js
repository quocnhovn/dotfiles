!function(h,t){"use strict";function n(e){if(!e.shortcut||e.shortcut.length<5)return null;let o=[];for(let t=0;t<=e.shortcut.length-5;t++){var l=e.shortcut.substring(t,t+5);o.push(l)}return o}function u(e,o,l){let r=5381;for(let t=o;t<l;t+=1)r=33*r^e.charCodeAt(t);return r>>>0}function c(t){return t?u(t,0,t.length):0}function e(e){if(this.lookupTable=new Map,this.histogram=new Map,e)for(let t=0;t<e.length;t++)this.addRule(e[t])}e.prototype={addRule:function(t){if(!(o=t).shortcut||o.shortcut.length<5||(o.shortcut.length<6&&0===o.shortcut.indexOf("ws:")||(o.shortcut.length<7&&0===o.shortcut.indexOf("|ws:")||(o.shortcut.length<9&&0===o.shortcut.indexOf("http")||o.shortcut.length<10&&0===o.shortcut.indexOf("|http")))))return!1;var e,o=n(t);if(!o)return!1;let l,r=Number.MAX_SAFE_INTEGER;for(e of o){var u=c(e),s=this.histogram.get(u)||0;s<r&&(r=s,l=u)}o=this.histogram.get(l)||0;if(this.histogram.set(l,o+1),this.lookupTable.has(l)){const i=this.lookupTable.get(l);h.utils.collections.isArray(i)?i.push(t):this.lookupTable.set(l,[i,t])}else this.lookupTable.set(l,t);return!0},removeRule:function(t){var e,o=n(t);if(!o)return!1;for(e of o){var l,r=c(e);this.lookupTable.has(r)&&(l=this.lookupTable.get(r),h.utils.collections.isArray(l)?(h.utils.collections.removeRule(l,t),0===l.length&&this.lookupTable.delete(r)):l.ruleText===t.ruleText&&this.lookupTable.delete(r))}},clearRules:function(){this.lookupTable.clear(),this.histogram.clear()},lookupRules:function(e){let o=null;for(let t=0;t<=e.length-5;t++){var l=u(e,t,t+5),l=this.lookupTable.get(l);if(l)if(h.utils.collections.isArray(l)){null===o&&(o=[]);for(var r of l)-1!==e.indexOf(r.shortcut)&&o.push(r)}else null===o&&(o=[]),-1!==e.indexOf(l.shortcut)&&o.push(l)}return o},getRules:function(){let e=[];return this.lookupTable.forEach(t=>{t&&(h.utils.collections.isArray(t)?e=e.concat(t):e.push(t))}),e}},t.ShortcutsLookupTable=e}(adguard,adguard.rules);