var browser=window.browser||chrome;!function(){function e(){function e(){browser.devtools.inspectedWindow.eval("DevToolsRulesConstructor.getElementInfo($0)",{useContentScriptContext:!0},function(e){e&&(e.attributes.sort(function(e,t){return("id"===e.name?0:"class"===e.name?1:2)-("id"===t.name?0:"class"===t.name?1:2)}),window.selectedElementInfo=e,c(),function(e,t){if(e)document.querySelector("#block-by-url-checkbox-block").style.display="block";else{document.querySelector("#block-by-url-checkbox").checked=false;document.querySelector("#block-by-url-checkbox-block").style.display="none"}if(t){document.querySelector("#create-full-css-path-block").style.display="block";document.querySelector("#create-full-css-path").checked=false}else{document.querySelector("#create-full-css-path").checked=true;document.querySelector("#create-full-css-path-block").style.display="none"}}(e.haveUrlBlockParameter,e.haveClassAttribute&&!e.haveIdAttribute),function(e){const t=document.getElementById("attributes-block");while(t.firstChild)t.removeChild(t.firstChild);const o=(e,t,o)=>{const c=o?'checked="true"':"";const n=`
                    <li class="parent">
                        <input class="enabled-button attribute-check-box" type="checkbox" id="attribute-check-box-${e}" ${c}>
                        <span class="webkit-css-property">${e}</span>:
                        <span class="value attribute-check-box-value">${t}</span>
                    </li>
            `;const l=document.createElement("div");l.innerHTML=n;return l.firstElementChild};if(e.tagName)t.appendChild(o("tag",e.tagName.toLowerCase(),true));for(var c=0;c<e.attributes.length;c++){var n=e.attributes[c];if(n.name==="class"&&n.value){var l=n.value.split(" ");for(var r=0;r<l.length;r++){var u=l[r];if(u)t.appendChild(o(n.name,u,true))}}else t.appendChild(o(n.name,n.value,n.name==="id"))}if(t.childNodes.length>2)document.querySelector("#select-attributes-checkbox").style.display="inline";else document.querySelector("#select-attributes-checkbox").style.display="none"}(e))})}!function(){var e;if(browser.devtools.panels.themeName==="dark")document.body.classList.add("-theme-with-dark-background")}(),o(),function(){var o=document.getElementById("preview-rule-button");o.addEventListener("click",function(e){e.preventDefault();if(window.selectedElementInfo){if(window.adguardDevToolsPreview){u();o.value="Preview";delete window.adguardDevToolsPreview;return}var t=document.getElementById("filter-rule-text").value;if(!t)return;r(t);o.value="Cancel preview";window.adguardDevToolsPreview=true}}),document.getElementById("add-rule-button").addEventListener("click",function(e){e.preventDefault();if(window.selectedElementInfo)d()});const e=document.querySelectorAll(".update-rule-block");e.forEach(e=>{e.addEventListener("click",()=>{n();c()})}),document.getElementById("select-attributes-checkbox").addEventListener("click",function(e){const t=e.currentTarget.checked;const o=document.querySelectorAll(".attribute-check-box");o.forEach(e=>{if(e)e.checked=t});n();c()})}(),browser.devtools&&browser.devtools.panels.elements.onSelectionChanged.addListener(e),browser.devtools&&browser.devtools.network.onNavigated.addListener(function(){document.getElementById("preview-rule-button").value="Preview",delete window.adguardDevToolsPreview}),e()}function o(){document.querySelector("#block-by-url-checkbox").checked=!1,document.querySelector("#create-full-css-path").checked=!1,document.querySelector("#one-domain-checkbox").checked=!0,document.querySelector("#filter-rule-text").value="";for(var e=document.getElementById("attributes-block");e.firstChild;)e.removeChild(e.firstChild)}var c=function(){t(function(e){l(window.selectedElementInfo,e)})},n=function(){const e=document.querySelectorAll("#one-domain-checkbox, #create-full-css-path, .attribute-check-box");document.querySelector("#block-by-url-checkbox").checked?e.forEach(e=>{e.setAttribute("disabled","disabled")}):e.forEach(e=>{e.removeAttribute("disabled")})},t=function(t){browser.devtools.inspectedWindow.eval("document.location && document.location.href",function(e){t(e)})},l=function(e,t){var o=document.querySelector("#block-by-url-checkbox").checked,c=document.querySelector("#create-full-css-path").checked,n=document.querySelector("#one-domain-checkbox").checked,l=!0,r=!0,u=[],d="";document.querySelectorAll(".attribute-check-box").forEach(function(e){var t;e&&("tag"===(t=e.id.substring("attribute-check-box-".length))?l=e.checked:"id"===t?r=e.checked:e.checked&&(e=e.parentNode.querySelector(".attribute-check-box-value").innerText,"class"===t?u.push(e):d+="["+t+'="'+e+'"]'))});c={urlMask:e.urlBlockAttributeValue,isBlockOneDomain:!n,url:t,ruleType:o?"URL":"CSS",cssSelectorType:c?"STRICT_FULL":"STRICT",attributes:d,excludeTagName:!l,excludeId:!r,classList:u},c="DevToolsRulesConstructor.constructRuleText($0, "+JSON.stringify(c)+");";browser.devtools.inspectedWindow.eval(c,{useContentScriptContext:!0},function(e){e&&(document.getElementById("filter-rule-text").value=e)})},r=function(e){e="DevToolsHelper.applyPreview("+JSON.stringify({ruleText:e})+");";browser.devtools.inspectedWindow.eval(e,{useContentScriptContext:!0})},u=function(){browser.devtools.inspectedWindow.eval("DevToolsHelper.cancelPreview();",{useContentScriptContext:!0})},d=function(){window.adguardDevToolsPreview&&u();var e,t=document.getElementById("filter-rule-text").value;t&&(e="DevToolsHelper.addRule("+JSON.stringify({ruleText:t})+");",browser.devtools.inspectedWindow.eval(e,{useContentScriptContext:!0},function(){r(t),delete window.selectedElementInfo,o()}))};document.addEventListener("DOMContentLoaded",function(){e()})}();