function injectPageScriptAPI(n,r,e){"use strict";const w=e?window[n]:function(){const i=window.postMessage,c=window.addEventListener;let a=0;const u={},s=function(e){if(e.data&&e.data.direction&&"to-page-script@adguard"===e.data.direction){const n=u[e.data.requestId];var t;n&&(t=n.wrapper,n.onResponseReceived(t,e.data.block),delete u[e.data.requestId])}};return{sendMessage:function(e,t,n,r){0===a&&c.call(window,"message",s,!1);var o=++a;u[o]={wrapper:n,onResponseReceived:r};t={requestId:o,direction:"from-page-script@adguard",elementUrl:e,documentUrl:document.URL,requestType:t};i.call(window,t,"*")}}}(),o=Function.prototype.toString.bind(injectPageScriptAPI);let i,c;if(window.WeakSet instanceof Function){e=new WeakSet;i=WeakSet.prototype.add.bind(e),c=WeakSet.prototype.has.bind(e)}else{const u=[];i=function(e){u.indexOf(e)<0&&u.push(e)},c=function(e){return 0<=u.indexOf(e)}}function a(e){try{var t;e&&!c(e)&&(i(e),e[n]=w,t=`'${n}', ${r}, true`,e.eval(`(${o()})(${t});`),delete e[n])}catch(e){}}var t=[HTMLFrameElement,HTMLIFrameElement,HTMLObjectElement];for(let e=0;e<t.length;e+=1)!function(e){const t=Object.getOwnPropertyDescriptor(e.prototype,"contentWindow"),n=Object.getOwnPropertyDescriptor(e.prototype,"contentDocument");if(t){const r=Function.prototype.call.bind(t.get),o=Function.prototype.call.bind(n.get);t.get=function(){var e=r(this);return a(e),e},n.get=function(){return a(r(this)),o(this)},Object.defineProperty(e.prototype,"contentWindow",t),Object.defineProperty(e.prototype,"contentDocument",n)}}(t[e]);r&&function(){if(window.RTCPeerConnection instanceof Function||window.webkitRTCPeerConnection instanceof Function){const u=window.RTCPeerConnection||window.webkitRTCPeerConnection,s=Function.prototype.call.bind(u.prototype.close),d=Array,t=String,l=Object.create,p=Object.defineProperty;if(u.prototype.setConfiguration){const f=Function.prototype.call.bind(u.prototype.setConfiguration);u.prototype.setConfiguration=function(e){e=n(e),f(this,e),c(this,e)}}a.prototype=u.prototype;var e=a.bind();function r(e){if(void 0!==e)return t(e)}function o(t,n){if(null===t||"object"!=typeof t)return t;var r=d(t.length);for(let e=0;e<r.length;e+=1)p(r,e,{configurable:!1,enumerable:!1,writable:!1,value:n(t[e])});return p(r,"length",{configurable:!1,enumerable:!1,writable:!1,value:r.length}),r}function n(e){if(null===e||"object"!=typeof e)return e;var t=o(e.iceServers,function(e){let{url:t,urls:n}=e;return void 0===n||n instanceof d||(n=[n]),l(e,{url:{configurable:!1,enumerable:!1,writable:!1,value:r(t)},urls:{configurable:!1,enumerable:!1,writable:!1,value:o(n,r)}})});return l(e,{iceServers:{configurable:!1,enumerable:!1,writable:!1,value:t}})}function i(t,e){!function(e,t,n){w.sendMessage(e,t,this,function(e,t){n(t)})}(e,"WEBRTC",function(e){if(e)try{s(t)}catch(e){}})}function c(t,e){if(e&&e.iceServers){var n=e.iceServers;for(let e=0;e<n.length;e+=1){var r=n[e];if(r&&(r.url&&i(t,r.url),r.urls))for(let e=0;e<r.urls.length;e+=1)i(t,r.urls[e])}}}function a(e,t){if(!(this instanceof a))return u();e=n(e);t=new u(e,t);return c(t,e),t}!function(t,n,r){for(let e=0;e<r.length;e+=1){var o=r[e],i=Object.getOwnPropertyDescriptor(t,o);i&&Object.defineProperty(n,o,i)}}(u,e,["caller","generateCertificate","name","prototype"]),u.prototype.constructor=e,"RTCPeerConnection"in window&&(window.RTCPeerConnection=e),"webkitRTCPeerConnection"in window&&(window.webkitRTCPeerConnection=e)}}()}const initPageMessageListener=function(){"use strict";window.addEventListener("message",function(t){var e;t.source===window&&t.data.direction&&"from-page-script@adguard"===t.data.direction&&t.data.elementUrl&&t.data.documentUrl&&(e={type:"checkPageScriptWrapperRequest",elementUrl:t.data.elementUrl,documentUrl:t.data.documentUrl,requestType:t.data.requestType,requestId:t.data.requestId},contentPage.sendMessage(e,function(e){e&&(e={direction:"to-page-script@adguard",elementUrl:t.data.elementUrl,documentUrl:t.data.documentUrl,requestType:t.data.requestType,requestId:e.requestId,block:e.block},t.source.postMessage(e,t.origin))}))},!1)};