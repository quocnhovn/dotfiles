adguard.frames=function(p){"use strict";function e(t,e,a,r){var i=p.tabs.getTabFrame(t.tabId,e);let s="";r===p.RequestTypes.DOCUMENT&&(p.tabs.clearTabFrames(t.tabId),p.tabs.clearTabMetadata(t.tabId),i&&(s=i.url)),p.tabs.recordTabFrame(t.tabId,e,a,p.utils.url.getDomainName(a)),r===p.RequestTypes.DOCUMENT&&(p.tabs.updateTabMetadata(t.tabId,{previousUrl:s}),l(t))}function a(t,e){return(e=p.tabs.getTabFrame(t.tabId,e))?e.url:null}function F(t){return(t=p.tabs.getTabFrame(t.tabId,0))?t.domainName:null}function h(t){const e=p.tabs.getTabMetadata(t.tabId,"frameWhiteListRule");return e&&e.isDocumentWhiteList()}function r(t){return p.tabs.getTabMetadata(t.tabId,"applicationFilteringDisabled")}function D(t){return p.tabs.getTabMetadata(t.tabId,"frameWhiteListRule")}function l(e){var a=p.tabs.getTabFrame(e.tabId,0);if(a){var r,i=p.settings.isFilteringDisabled();let t=null;i||(r=a["url"],(a=p.localStorage.getItem("is-whiteList-filter-status"))&&"false"==a&&(t=p.whitelist.findWhiteListRule(r)),t=t||p.requestFilter.findWhiteListRule(r,r,p.RequestTypes.DOCUMENT)),p.tabs.updateTabMetadata(e.tabId,{frameWhiteListRule:t,applicationFilteringDisabled:i})}}return p.listeners.addListener(t=>{t===p.listeners.APPLICATION_INITIALIZED&&p.tabs.forEach(t=>{e(t,0,t.url,p.RequestTypes.DOCUMENT)})}),{recordFrame:e,getFrameUrl:a,getMainFrameUrl:function(t){return a(t,p.MAIN_FRAME_ID)},getFrameDomain:F,isTabWhiteListed:h,isTabWhiteListedForSafebrowsing:function(t){return h(t)&&p.whitelist.isDefaultMode()},isTabProtectionDisabled:r,isTabAdguardWhiteListed:function(t){return p.tabs.getTabMetadata(t.tabId,"adguardDocumentWhiteListed")},getTabAdguardUserWhiteListRule:function(t){return p.tabs.getTabMetadata(t.tabId,"adguardUserWhiteListed")?p.tabs.getTabMetadata(t.tabId,"adguardWhiteListRule"):null},getFrameWhiteListRule:D,reloadFrameData:l,recordFrameReferrerHeader:function(t,e){p.tabs.updateTabMetadata(t.tabId,{referrerUrl:e})},getFrameInfo:function(t){const a=t["tabId"];var e=p.tabs.getTabFrame(a);let r=t["url"];!r&&e&&(r=e.url);var i=p.localStorage.isInitialized(),s=!p.utils.url.isHttpRequest(r),l=i&&!s;let d=!1,u=!1,n=!1,b;var o=p.pageStats.getTotalBlocked();const c={};let g=0;Object.keys(o).forEach(t=>{var e=p.tabs.getTabMetadata(a,t)||0;c[t]=e,g+=e});let T=0;for(const m in o)for(const I in o[m])T+=parseInt(o[m][I]);e=p.settings.isFilteringDisabled();l&&(d=h(t),d&&(f=D(t),u=p.utils.filters.isWhiteListFilterRule(f)||p.utils.filters.isUserFilterRule(f),b={filterId:f.filterId,ruleText:f.ruleText}),n=!(d&&!u));var i=F(t),f=p.settings.isDisableAllowAcceptableAds(),t=p.settings.isDisablePornSwitch();return{url:r,applicationAvailable:l,domainName:i,applicationFilteringDisabled:e,urlFilteringDisabled:s,documentWhiteListed:d,userWhiteListed:u,canAddRemoveRule:n,frameRule:b,adguardProductName:"",totalBlockedTab:g,BlockedTab:c,allHistoryBlocked:T,allowAppeptableAdsDisable:f,PornSwitchDisable:t}},updateBlockedAdsCount:function(t,e,a){e=(p.tabs.getTabMetadata(t.tabId,a)||0)+e;let r={};return r[a]=e,p.tabs.updateTabMetadata(t.tabId,r),e},resetBlockedAdsCount:function(t){t?p.tabs.updateTabMetadata(t.tabId,{blocked:0}):p.pageStats.resetStats()},isIncognitoTab:function(t){return p.tabs.isIncognito(t.tabId)},shouldStopRequestProcess:t=>r(t)||h(t),checkAndRecordMainFrame:(t,e,a,r)=>{if(r===p.RequestTypes.DOCUMENT){var i=t["tabId"],r=p.tabs.getTabFrame(i,e);if(!r)return p.tabs.recordTabFrame(i,e,a,p.utils.url.getDomainName(a)),void l(t);r&&r.url!==a&&(r=r.url,p.tabs.clearTabFrames(i),p.tabs.clearTabMetadata(i),p.tabs.recordTabFrame(i,e,a,p.utils.url.getDomainName(a)),p.tabs.updateTabMetadata(i,{previousUrl:r}),l(t))}}}}(adguard);