(()=>{const W=(()=>{const W=sessionStorage.getItem("bis_data");return null!==W?JSON.parse(W):null})(),q=W?.config?`${W.id}_t`:null,k=W?.config?.aiMessagesConfig?.GEMINI||{},{PARSERS:u=[],CHATBOT_NAME:O="",QUERY_GET_CHAT_MODEL:p,QUERY_GET_SUBSCRIPTION:b,PAID_SUBSCRIPTION_VALUES:s}=k,y=function(){const W=document.querySelector(b)?.textContent;return s.some((q=>q===W?.toLowerCase()))},E=function(W,k,u,b){let s={chatbotName:O,chatModel:document.querySelector(p)?.textContent,subscription:y(),messages:[]},E={},R={};if(W?.length){let q=decodeURIComponent(W),u=q.split(b.GENERAL_DATA.SEPARATOR_PARAMETERS)?.[0];if(u){let W=u.replace(new RegExp(b.GENERAL_DATA.REPLACEMENT_PARAMETER,"g"),""),q=JSON.parse(JSON.parse(W)?.filter((W=>W)))?.filter((W=>W))?.[2]?.[0],O=self.location.href.match(new RegExp(b.GENERAL_DATA.REGEXP_SESSION_ID_FROM_URL))?.groups?.sessionId;s.sessionId=q.length?q.replace(new RegExp(b.GENERAL_DATA.REPLACEMENT_PREFIX_SESSION_ID),""):O,Q(E,W,k,b.SENT_MESSAGE)}}i(R,u,b.RECEIVED_MESSAGE),E?.messageText&&s.messages.push(E),R?.messageText&&s.messages.push(R),s.messages.length&&setTimeout((()=>(W=>{try{let k={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"GEMINI_DATA",from:q,to:q.substring(0,q.length-2),content:W};window.postMessage(k)}catch(W){}})(s)),0)},R=function(W,q,k,u){try{E(W,k,q,u)}catch(W){}},i=function(W,q,k){if(!q?.length)return;let u="",O=q.replace(new RegExp(k.REGEXP_REMOVE_GARBAGE),"").split(new RegExp(k.REGEXP_SPLITER)).map((W=>W.trim())).filter((W=>W)),p=[0,0];for(let W of O){let q=O.indexOf(W);p[1]<W.length&&(p[1]=W.length,p[0]=q)}if(k.RED_FLAG_VALUES_FOR_MEDIA.some((W=>O[p[0]].includes(W))))return;let b=new RegExp(k.REGEXP_GET_MESSAGE_TEXT);u=O[p[0]].match(b)?.groups?.message,u&&h(W,u,k)},h=function(W,q,k){W.messageText=q,W.messageType=k.MESSAGE_TYPE,W.creationTime=null,n(W,k.MESSAGE_LENGTH||3e4)},Q=function(W,q,k,u){try{X(W,q,k,u)}catch(W){}},X=function(W,q,k,u){let O=JSON.parse(JSON.parse(q)?.filter((W=>W)))?.filter((W=>W))?.[0]?.[0];O?.length?(W.messageText=O,W.messageType=u.MESSAGE_TYPE,W.creationTime=k,n(W,u.MESSAGE_LIMIT||1e4)):W=null},n=function(W,q){let k=W.messageText,u=k.split("");"\\"===u[u.length-1]&&(u[u.length-1]="",k=u.join("")),W.messageText=k.trim().slice(0,q),W.messageLength=k.length},D={XMLHttpRequest:function(W){const q=XMLHttpRequest.prototype.open,k=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(W,k){return this._requestMethod=W,this._requestUrl=k,q.apply(this,arguments)},XMLHttpRequest.prototype.send=function(q){let u=this.onreadystatechange;const O=new Date;return this.onreadystatechange=function(){try{4===this.readyState&&function(W,q,k){return new RegExp(k.REGEXP_URL_CHECK).test(W)&&q===k.REQUEST_METHOD}(this._requestUrl,this._requestMethod,W)&&setTimeout(R.bind(this,q,this.responseText,O,W),0)}catch(W){if(u)return u.apply(this,arguments)}if(u)return u.apply(this,arguments)},k.apply(this,arguments)}}};!function(){for(let W of u)W.USE&&D[W.TYPE](W)}()})();