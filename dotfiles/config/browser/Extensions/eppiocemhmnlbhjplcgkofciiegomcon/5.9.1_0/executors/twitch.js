(()=>{function W(W,q,k,u,O=null){try{document.location.host;let p="detector",b=k;!b&&O&&(b=O[0]?.type?O[0].type:null);let s={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"VIDEO_XHR_CANDIDATE",from:p,to:p.substring(0,p.length-2),content:{requestMethod:W,url:q,type:b,content:u}};if(O&&O instanceof Promise)return void O.then((W=>{s.content.encodedPostBody=W,s.type="VIDEO_TWITCH_INSTREAM_DATA",window.postMessage(s,"*")}));u?.includes("streamPlaybackAccessToken")&&(s.type="VIDEO_TWITCH_INSTREAM_DATA"),window.postMessage(s,"*")}catch(W){}}let q=XMLHttpRequest.prototype.open,k=XMLHttpRequest.prototype.send,u=fetch;XMLHttpRequest.prototype.open=function(){this.requestMethod=arguments[0],q.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){const q=Object.assign(arguments,{});let u=this.onreadystatechange;return this.onreadystatechange=function(){if(4!==this.readyState||function(W){const q=document.querySelector("script[data-bis-config]")?JSON.parse(document.querySelector("script[data-bis-config]").getAttribute("data-bis-config")):null;return!!q&&q.some((q=>W.includes(q)))}(this.responseURL)||W(this.requestMethod,this.responseURL,this.getResponseHeader("content-type"),this.response,q),u)return u.apply(this,arguments)},k.apply(this,arguments)},fetch=function(){const q=arguments;let k=arguments[0]instanceof Request?arguments[0].url:arguments[0];const O=arguments[0]instanceof Request?arguments[0].method:arguments[1]?.method?arguments[1].method:"GET",p="POST"===O?arguments[1].body:null;return"object"==typeof k&&k.href&&(k=k.href),new Promise(((b,s)=>{u.apply(this,q).then((function(q){if(q.body instanceof ReadableStream){const u=q.headers.get("content-type"),b=q.json;q.json=function(){return new Promise(((s,y)=>{b.apply(this,arguments).then((function(b){0!==q.url.search(/data:application\/json;base64/)&&W(O,k,u,JSON.stringify(b),p),s(b)})).catch((function(W){y(W)}))}))};const s=q.text;q.text=function(){return new Promise(((b,y)=>{s.apply(this,arguments).then((function(s){0!==q.url.search(/data:application\/json;base64/)&&W(O,k,u,s,p),b(s)})).catch((function(W){y(W)}))}))},new RegExp("video-edge.*.ts$").test(k)&&"POST"===O&&p?.arrayBuffer&&W(O,k,p.type,null,p.text())}b.apply(this,arguments)})).catch((function(W){s.apply(this,arguments)}))}))}})();