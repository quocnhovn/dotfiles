(()=>{const W=(()=>{const W=sessionStorage.getItem("bis_data");return null!==W?JSON.parse(W):null})(),q=W?.config?`${W.id}_t`:null,k=W?.config?.aiMessagesConfig?.DEEPSEEK||{},{PARSERS:u=[],CHATBOT_NAME:O=""}=k,p=function(W,k,u,p){let y={chatbotName:O,chatModel:"",subscription:!1,messages:[]},E={},R={};if(W?.length){let q=JSON.parse(W);b(y,q,p.GENERAL_DATA.GET_BY_PATH),function(W,q,k,u){try{if(b(W,q,u.RULES_GET_USER_VALUES),!W?.messageText)return null;W.creationTime=k,s(W,u?.MESSAGE_LIMIT||1e4)}catch(W){}}(E,q,k,p.SENT_MESSAGE)}!function(W,q,k){if(!q?.length)return null;try{if(b(W,q,k.RULES_GET_SYSTEM_VALUES),!W?.messageText)return null;s(W,k?.MESSAGE_LIMIT||3e4)}catch(W){}}(R,u,p.RECEIVED_MESSAGE),E?.messageText&&y.messages.push(E),R?.messageText&&y.messages.push(R),y.messages.length&&setTimeout((()=>(W=>{try{let k={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"DEEPSEEK_DATA",from:q,to:q.substring(0,q.length-2),content:W};window.postMessage(k)}catch(W){}})(y)),0)},b=function(W,q,k){for(let u of k)u.PATH?.length?"payload"===u.SOURCE?W[u.NAME]=R.byPath(q,u.PATH):W[u.NAME]=R.byPath(null,u.PATH):u.REDUCE_PARAMS?W[u.NAME]=R.byReduce(q,u.REDUCE_PARAMS):u.CONSTANT_VALUE&&(W[u.NAME]=u.CONSTANT_VALUE)},s=function(W,q){let k=W.messageText;W.messageText=k.trim().slice(0,q),W.messageLength=k.length},y=async function(W,q,k,u){let O=[];try{let q=W.split("\n");for(let W=0;W<q.length;W++){const k=q[W].trim();if(k.startsWith("data:")){const W=k.slice(5).trim();try{O.push(JSON.parse(W))}catch(W){}}}}catch(W){}finally{p(q,k,O,u)}},E={XMLHttpRequest:function(W){const q=XMLHttpRequest.prototype.open,k=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(W,k){return this._requestMethod=W,this._requestUrl=k,q.apply(this,arguments)},XMLHttpRequest.prototype.send=function(q){let u=this.onreadystatechange;const O=new Date;return this.onreadystatechange=function(){if(4===this.readyState&&function(W,q,k){return new RegExp(k.REGEXP_URL_CHECK).test(W)&&q===k.REQUEST_METHOD}(this._requestUrl,this._requestMethod,W)&&setTimeout(y.bind(this,this.responseText,q,O,W),0),u)return u.apply(this,arguments)},k.apply(this,arguments)}}},R={byReduce:(W,q)=>{const{KEY:k,INVALID_VALUES:u,TYPE:O,RED_FLAG_PATH:p,RED_FLAG_VALUE:b}=q;if(p?.length)for(let q of W){let W=q;for(let q=0;q<p.length;q++){const k=p[q];if(!W[k]){W=null;break}W=W[k]}if(W===b)return null}return W.reduce(((W,q)=>(q.hasOwnProperty(k)?typeof q[k]===O&&u.some((W=>q[k]!==W))&&(W+=q[k]):W+="",W)),"")},byPath:(W,q)=>{for(let k=0;k<q.length;k++){const u=q[k];if(!W[u]){W=null;break}W=W[u]}return W}};!function(){for(let W of u)W.USE&&E[W.TYPE](W)}()})();